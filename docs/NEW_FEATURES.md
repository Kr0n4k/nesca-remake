# Новые функции Nesca v2r

## 1. Статистика в реальном времени (Live Statistics)

### Описание
Во время сканирования отображается информация о прогрессе в реальном времени, которая обновляется каждые 2 секунды.

### Что отображается:
- **Процент выполнения** - процент отсканированных IP-адресов
- **Scanned** - количество отсканированных IP / общее количество
- **Found** - количество найденных устройств
- **Saved** - количество сохраненных результатов
- **По типам** - количество камер, устройств с аутентификацией, SSH и т.д.
- **Speed** - скорость сканирования (IP/сек)
- **Threads** - количество активных потоков
- **ETA** - примерное время до завершения

### Использование:

```bash
# По умолчанию включена
./nesca --ip 192.168.1.0/24 -p 80,443

# Явно включить
./nesca --ip 192.168.1.0/24 -p 80,443 --live-stats

# Отключить
./nesca --ip 192.168.1.0/24 -p 80,443 --no-live-stats
```

### Пример вывода:
```
[PROGRESS] 45.3% | Scanned: 453/1000 | Found: 23 | Saved: 15 | Cam:8 Auth:5 SSH:2 | Speed: 22.5 IP/s | Threads: 87 | ETA: 24m 15s
```

## 2. Определение типа устройств (Device Identification)

### Описание
Автоматическое определение производителя и модели IP-камер по заголовкам HTTP и содержимому страниц.

### Поддерживаемые производители:
- **Hikvision** - DS-, IPC-, DVR-, NVR- серии
- **Dahua** - IPC-, DHI-, DH- серии  
- **Axis** - P, M, Q серии
- **Panasonic** - WV-, BB- серии
- **Sony** - SNC-, IPELA серии
- **Samsung, Bosch, Pelco, Vivotek, Foscam, Uniview, Reolink, TP-Link** и другие

### Использование:
Функция автоматически интегрирована в процесс сканирования. Определение происходит при обнаружении устройств.

### API для разработчиков:

```cpp
#include "DeviceIdentifier.h"

// Полная информация об устройстве
DeviceInfo info = DeviceIdentifier::identify(headers, body);
// info.manufacturer - производитель
// info.model - модель
// info.firmware - версия прошивки
// info.deviceType - тип устройства (camera, dvr, nvr)
// info.confidence - уровень уверенности (high, medium, low)

// Получить только производителя
QString manufacturer = DeviceIdentifier::getManufacturer(headers, body);

// Проверить, является ли устройство определенной маркой
bool isHikvision = DeviceIdentifier::isBrand("Hikvision", headers, body);
```

## 3. Итоговая статистика после сканирования

### Описание
После завершения сканирования выводится подробная сводная статистика.

### Что отображается:
- **Duration** - длительность сканирования
- **Average Speed** - средняя скорость сканирования
- **Targets** - общее количество целей
- **Found** - найденные устройства с процентом успеха
- **Saved** - сохраненные результаты с процентом от найденных
- **By Type** - распределение по типам (камеры, аутентификация, SSH и т.д.)
- **Alive** - количество живых устройств
- **Filtered** - количество отфильтрованных результатов

### Пример вывода:
```
===========================================================
Scan Summary:
-----------------------------------------------------------
Duration:        125 seconds
Average Speed:   8.42 IPs/sec
Targets:         1054 total
Found:           47 nodes (4.46%)
Saved:           32 nodes (68.1%)

By Type:
  Cameras:       18
  Auth:          12
  SSH:           2
Alive:           47
===========================================================
```

## Комбинированное использование

```bash
# Полный набор функций: живая статистика + экспорт + итоговая сводка
./nesca --ip 192.168.1.0/24 -p 80,443,8080 --export both --live-stats

# Экспорт с фильтрацией только камер
./nesca --export-only --export-filter-type camera --export json

# Сканирование без живой статистики (для старых терминалов)
./nesca --ip 192.168.1.0/24 -p 80,443 --no-live-stats
```

## Технические детали

- **Производительность**: Мониторинг прогресса работает в отдельном потоке и не замедляет сканирование
- **Совместимость**: Поддерживаются все терминалы с ANSI цветами
- **Точность**: Определение устройств основано на анализе HTTP-заголовков и содержимого страниц
- **Расширяемость**: Легко добавить новые производители через DeviceIdentifier

## Преимущества

1. **Видимость прогресса** - всегда знаете, сколько осталось до завершения
2. **Оптимизация** - видите скорость работы и можете скорректировать параметры
3. **Информативность** - знаете, какие устройства найдены и их типы
4. **Автоматизация** - определение производителей помогает в автоматической обработке результатов

